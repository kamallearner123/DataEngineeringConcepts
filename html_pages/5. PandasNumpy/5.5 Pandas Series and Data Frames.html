<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pandas: Creating and Modifying Series & DataFrames</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f9f9f9;
            color: #333;
            margin: 0;
            padding: 0 20px;
        }
        header {
            background-color: #306998;
            color: white;
            padding: 20px 0;
            text-align: center;
        }
        h1 {
            margin: 0;
        }
        section {
            max-width: 900px;
            margin: 40px auto;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        code {
            background-color: #eee;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
        }
        pre {
            background: #2d2d2d;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 10px 0;
            line-height: 1.6;
        }
        .question {
            background: #e8f4f8;
            padding: 15px;
            margin: 10px 0;
            border-left: 5px solid #007bff;
        }
        .answer {
            display: none;
            background: #f1f1f1;
            padding: 10px;
            margin-top: 5px;
        }
        .toggle-answer {
            color: #007bff;
            cursor: pointer;
            text-decoration: underline;
        }
        .code-box {
            position: relative;
        }
        .code-box::before {
            content: 'Python';
            position: absolute;
            top: 0;
            right: 10px;
            color: #aaa;
            font-size: 0.8em;
        }
        .code-box code {
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <header>
        <h1>Pandas: Creating and Modifying Series & DataFrames</h1>
    </header>

    <section>
        <h2>Creating Series</h2>
        <h3>From Lists, Arrays, or Dictionaries</h3>
        <p>A <code>Series</code> is a one-dimensional labeled array that can be created from lists, NumPy arrays, or dictionaries, offering flexibility for data representation.</p>
        <div class="code-box">
            <pre><code class="language-python">import pandas as pd
import numpy as np

# From list
s1 = pd.Series([10, 20, 30])
print(s1)
# Output:
# 0    10
# 1    20
# 2    30
# dtype: int64

# From NumPy array
s2 = pd.Series(np.array([1.5, 2.5, 3.5]))
print(s2)
# Output:
# 0    1.5
# 1    2.5
# 2    3.5
# dtype: float64

# From dictionary
s3 = pd.Series({'a': 100, 'b': 200, 'c': 300})
print(s3)
# Output:
# a    100
# b    200
# c    300
# dtype: int64
</code></pre>
        </div>

        <h3>Specifying Custom Indices</h3>
        <p>Custom indices can be set during Series creation to provide meaningful labels, enhancing data interpretability.</p>
        <div class="code-box">
            <pre><code class="language-python">import pandas as pd

# Series with custom index
s = pd.Series([5, 10, 15], index=['Jan', 'Feb', 'Mar'])
print(s)
# Output:
# Jan     5
# Feb    10
# Mar    15
# dtype: int64
</code></pre>
        </div>

        <h3>Series Attributes (values, index, name)</h3>
        <p>Attributes like <code>values</code> (data as a NumPy array), <code>index</code> (labels), and <code>name</code> (Series identifier) provide metadata access.</p>
        <div class="code-box">
            <pre><code class="language-python">import pandas as pd

s = pd.Series([1, 2, 3], index=['x', 'y', 'z'], name='Data')
print(s.values)  # Output: [1 2 3]
print(s.index)   # Output: Index(['x', 'y', 'z'], dtype='object')
print(s.name)    # Output: Data
</code></pre>
        </div>
    </section>

    <section>
        <h2>Creating DataFrames</h2>
        <h3>From Dictionaries, Lists, or NumPy Arrays</h3>
        <p><code>DataFrames</code> are two-dimensional tabular structures created from dictionaries (columns), lists (rows), or NumPy arrays for structured data.</p>
        <div class="code-box">
            <pre><code class="language-python">import pandas as pd
import numpy as np

# From dictionary
df1 = pd.DataFrame({'Name': ['Alice', 'Bob'], 'Age': [25, 30]})
print(df1)
# Output:
#     Name  Age
# 0  Alice   25
# 1    Bob   30

# From list of lists
df2 = pd.DataFrame([[1, 'A'], [2, 'B']], columns=['ID', 'Grade'])
print(df2)
# Output:
#    ID Grade
# 0   1     A
# 1   2     B

# From NumPy array
df3 = pd.DataFrame(np.array([[10, 20], [30, 40]]), columns=['X', 'Y'])
print(df3)
# Output:
#     X   Y
# 0  10  20
# 1  30  40
</code></pre>
        </div>

        <h3>Setting Column Names and Indices</h3>
        <p>Column names and indices can be specified during creation or modified later to align with the dataset's context.</p>
        <div class="code-box">
            <pre><code class="language-python">import pandas as pd

# DataFrame with custom columns and index
df = pd.DataFrame({'Score': [85, 90], 'Status': ['Pass', 'Pass']}, index=['Test1', 'Test2'])
print(df)
# Output:
#        Score Status
# Test1     85   Pass
# Test2     90   Pass
</code></pre>
        </div>

        <h3>DataFrame Attributes (columns, index, shape)</h3>
        <p>Attributes like <code>columns</code> (column labels), <code>index</code> (row labels), and <code>shape</code> (dimensions) describe the DataFrame's structure.</p>
        <div class="code-box">
            <pre><code class="language-python">import pandas as pd

df = pd.DataFrame({'A': [1, 2, 3], 'B': ['x', 'y', 'z']}, index=['p', 'q', 'r'])
print(df.columns)  # Output: Index(['A', 'B'], dtype='object')
print(df.index)    # Output: Index(['p', 'q', 'r'], dtype='object')
print(df.shape)    # Output: (3, 2)
</code></pre>
        </div>
    </section>

    <section>
        <h2>Modifying Series and DataFrames</h2>
        <h3>Adding or Renaming Columns/Indices</h3>
        <p>New columns can be added via assignment, and <code>rename()</code> updates column names or indices without altering data.</p>
        <div class="code-box">
            <pre><code class="language-python">import pandas as pd

# Add new column
df = pd.DataFrame({'A': [10, 20, 30]})
df['B'] = df['A'] * 2
print(df)
# Output:
#     A   B
# 0  10  20
# 1  20  40
# 2  30  60

# Rename columns and indices
df = df.rename(columns={'A': 'X', 'B': 'Y'}, index={0: 'a', 1: 'b', 2: 'c'})
print(df)
# Output:
#     X   Y
# a  10  20
# b  20  40
# c  30  60
</code></pre>
        </div>

        <h3>Converting Data Types</h3>
        <p>Use <code>astype()</code> or specific converters to change the data types of Series or DataFrame columns for compatibility or analysis.</p>
        <div class="code-box">
            <pre><code class="language-python">import pandas as pd

# Convert data types
df = pd.DataFrame({'A': ['1', '2', '3'], 'B': [4.5, 5.5, 6.5]})
df['A'] = df['A'].astype(int)
df['B'] = df['B'].astype(int)
print(df)
# Output:
#    A  B
# 0  1  4
# 1  2  5
# 2  3  6
</code></pre>
        </div>

        <h3>Copying vs. Modifying in Place</h3>
        <p>Modifications can be applied in place or on a copy using <code>copy()</code> to preserve the original data.</p>
        <div class="code-box">
            <pre><code class="language-python">import pandas as pd

# Modify in place
df = pd.DataFrame({'A': [1, 2, 3]})
df['A'] = df['A'] + 10
print(df)
# Output:
#     A
# 0  11
# 1  12
# 2  13

# Create a copy
df_copy = df.copy()
df_copy['A'] = df_copy['A'] * 2
print(df_copy)
# Output:
#     A
# 0  22
# 1  24
# 2  26
print(df)  # Original unchanged
# Output:
#     A
# 0  11
# 1  12
# 2  13
</code></pre>
        </div>
    </section>

    <section>
        <h2>Challenging Questions</h2>
        <div class="question">
            <p><strong>Question 1:</strong> What will be the output of this code, and why?</p>
            <div class="code-box">
                <pre><code class="language-python">import pandas as pd

s = pd.Series([10, 20, 30], index=['x', 'y', 'z'], name='Values')
s.index = ['a', 'b', 'c']
print(s.name)
</code></pre>
            </div>
            <span class="toggle-answer" onclick="toggleAnswer('answer1')">Show Answer</span>
            <div id="answer1" class="answer">
                <p><strong>Answer:</strong> Values</p>
                <p><strong>Explanation:</strong> The <code>name</code> attribute of the Series is set to <code>'Values'</code> during creation. Changing the index to <code>['a', 'b', 'c']</code> does not affect the <code>name</code> attribute, so it remains <code>Values</code>.</p>
            </div>
        </div>

        <div class="question">
            <p><strong>Question 2:</strong> Why does this code produce unexpected results, and how can it be fixed?</p>
            <div class="code-box">
                <pre><code class="language-python">import pandas as pd

df = pd.DataFrame({'A': [1, 2, 3]})
df['B'] = df['A']
df['B'][0] = 10
print(df)
</code></pre>
            </div>
            <span class="toggle-answer" onclick="toggleAnswer('answer2')">Show Answer</span>
            <div id="answer2" class="answer">
                <p><strong>Answer:</strong> The code may raise a <code>SettingWithCopyWarning</code> because <code>df['B'][0] = 10</code> can create a view or copy, leading to ambiguous modification behavior.</p>
                <p><strong>Fix:</strong> Use <code>.loc</code> to explicitly modify the DataFrame in place.</p>
                <div class="code-box">
                    <pre><code class="language-python">import pandas as pd

df = pd.DataFrame({'A': [1, 2, 3]})
df['B'] = df['A']
df.loc[0, 'B'] = 10
print(df)
# Output:
#    A   B
# 0  1  10
# 1  2   2
# 2  3   3
</code></pre>
                </div>
            </div>
        </div>

        <div class="question">
            <p><strong>Question 3:</strong> What will be the output of this code, and why?</p>
            <div class="code-box">
                <pre><code class="language-python">import pandas as pd

df = pd.DataFrame({'A': ['1', '2', '3']}, index=['x', 'y', 'z'])
df['A'] = df['A'].astype(float)
print(df.dtypes)
</code></pre>
            </div>
            <span class="toggle-answer" onclick="toggleAnswer('answer3')">Show Answer</span>
            <div id="answer3" class="answer">
                <p><strong>Answer:</strong> A    float64<br>dtype: object</p>
                <p><strong>Explanation:</strong> The <code>astype(float)</code> method converts the string values in column <code>A</code> to floating-point numbers, resulting in a <code>float64</code> data type for the column.</p>
            </div>
        </div>
    </section>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script>
        function toggleAnswer(id) {
            const answer = document.getElementById(id);
            answer.style.display = answer.style.display === 'block' ? 'none' : 'block';
        }
    </script>
</body>
</html>